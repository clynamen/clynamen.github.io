
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Experimente mit Rust - Carsim2d [DE] - The Infornographer</title>
  <meta name="author" content="Vincenzo Giovanni Comito">

  
  <meta name="description" content="Es sind Jahre, Ich wollte etwas mit Rust machen.
Als moderner C++ Programmierer zu sein mag ich natürlich Rust:
Die Programmiersprache hat die &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://clynamen.github.io/blog/2019/02/04/carsim2d">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The Infornographer" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/banner-scroll.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header id="main-banner" role="banner">
	<div class="header-title"><a href="/">The Infornographer</a></div>


</header>
  <div id="main-banner-placeholder"></div>
  <div id="social-bar" style="height: 66px;">
    <a href="https://twitter.com/cIynamen" target="_blank" id="social-bar-twitter"></a>
    <a href="https://github.com/clynamen/" target="_blank" id="social-bar-github"></a>
    <a href="/extras/resume.pdf" target="_blank" id="social-bar-resume" title='resume'></a>
  </div>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:clynamen.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
  
    
      <h1 class="entry-title">Experimente Mit Rust - Carsim2d [DE]</h1>
    
  
    
      <p class="meta">
        








  


<time datetime="2019-02-04T01:00:00+02:00" pubdate data-updated="true"></time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Es sind Jahre, Ich wollte etwas mit Rust machen.
Als moderner C++ Programmierer zu sein mag ich natürlich Rust:
Die Programmiersprache hat die Funktione, die mir am besten gefallen:</p>

<ul>
<li>Kompilierzeitprüfungen</li>
<li>Guter package manager</li>
<li>Kein garbage-collector, aber ein borrow-checker</li>
</ul>


<p>Ich hatte die Idee, ein Videospiele zu machen. Aber Ich weiß, Ich brauche mehr Zeit.
Rust is nicht so gut als C++ für Videospiele: es ist möglich, Opengl oder Vulkan zu verwenden.
Aber es gibt keine or klein library dafür. Zum Beispiel, <a href="https://www.piston.rs/">piston</a> ist eine 2D Game library mit wenige, langsame Funktionen.
<a href="https://www.amethyst.rs/">Amethyst</a> ist vielversprechender. Diese library ist insipiriert aus data-driven Prinzipen und
es ist auf eine <a href="https://github.com/slide-rs/specs">Entity Component System</a> aufgebaut. Amethyst ist jedoch noch unreif.  Die Entwicker versuchen, die Grafik-Engine schenller zu machen.
Außerdem würde Ich gerne Opengl vergessen und geh direkt mit Vulkan, aber seine Gemeinschaft ist kleine.</p>

<p>Anstatt ein Videospiele zu machen, suchte Ich nach einer anderen Chance.
Ich brauchte ein einfach Fahrzeug-Simulator auf Arbeit mit ROS-Unterstützung. Keine komplexen Grafiken,
vielleicht etwas Physik. Die gegenwärtig verfügbar libraries für Rust sollten passen.</p>

<h3>Roadsim2D</h3>

<p>Roadsim2D ist nur a toy-project. Ich wollte ein Simulator wo man kannt 2D Autos Steuren</p>

<p>Ich schreibe roadsim2D als mein erstes rust Projekt. Ich lerne immer noch, wie die borrow-checker funktioniert.
Ich muss sagen: am Anfang, man verschwendet Zeit auch im die einfachesten Dinge. Der compiler hilft dir mit Fehlerbeschreibung, doch die richtige Lösung ist oft spezifisch.
Schließlich du musst lernen wie den Programm besser entwürfen. Du lernst wenn du spielst gegen den compiler.
Ich habe piston benutzt, um basisch Form zeichen. Die Library steuert geometrisch Transform, so ist es leicht eine Kamera hinzufügen. Ich wollte das nicht kodieren.</p>

<p>Nach dem die Kamera, die Autos wurden hinzugefügt. Ihre Bewegungen folgen die <a href="https://en.wikipedia.org/wiki/Ackermann_steering_geometry">Ackermann</a> Lenkmodell.
Ich hatte bald Probleme mit die Borrow-checker: zu viele Variables werden benutzen von zu viele Komponente.
Es wurde klar, ich musste den Code umgestalten.</p>

<p>Beim Lesen über Amethyst, Ich habe <a href="https://github.com/slide-rs/specs">specs</a> entdeckt. specs ist eine library fur data-oriented programming, ein Paradigma in Game Development sehr bekannt.
In diese library, der Programmierer musst Komponenten und Systemen definieren. Komponenten haben
data, Systeme haben Code, die die Komponenten verändern.
Nicht nur das macht das Programm (potenziell) schneller, das macht alles einfacher als voher zu codieren. Mit specs, es ist explizit, was ist konstant und was kannt änderen. Und du kannst das Leben von Komponenten mit die Entitäten steuern.</p>

<p>Zum Beispiel, schauen wir mal, wie die Physik von Autos ist aktualisiert:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='rust'><span class='line'><span class="k">impl</span><span class="o">&lt;</span><span class="nl">&#39;a</span><span class="p">,</span> <span class="nl">&#39;b</span><span class="o">&gt;</span> <span class="n">System</span><span class="o">&lt;</span><span class="nl">&#39;a</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">UpdateCarsSys</span><span class="o">&lt;</span><span class="nl">&#39;b</span><span class="o">&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="n">SystemData</span> <span class="o">=</span> <span class="p">(</span><span class="n">ReadExpect</span><span class="o">&lt;</span><span class="nl">&#39;a</span><span class="p">,</span> <span class="n">UpdateDeltaTime</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">WriteStorage</span><span class="o">&lt;</span><span class="nl">&#39;a</span><span class="p">,</span> <span class="n">PhysicsComponent</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">ReadStorage</span><span class="o">&lt;</span><span class="nl">&#39;a</span><span class="p">,</span> <span class="n">Car</span><span class="o">&gt;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">fn</span> <span class="n">run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">update_delta_time</span><span class="p">,</span> <span class="k">mut</span> <span class="n">physics_components</span><span class="p">,</span> <span class="k">mut</span> <span class="n">cars</span><span class="p">)</span><span class="o">:</span> <span class="n">Self</span><span class="o">::</span><span class="n">SystemData</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="n">physics_component</span><span class="p">,</span> <span class="n">car</span><span class="p">)</span> <span class="k">in</span> <span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">physics_components</span><span class="p">,</span> <span class="o">&amp;</span> <span class="n">cars</span><span class="p">).</span><span class="n">join</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="kd">let</span> <span class="k">mut</span> <span class="n">rigid_body</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">physics_world</span><span class="p">.</span><span class="n">rigid_body_mut</span><span class="p">(</span><span class="n">physics_component</span><span class="p">.</span><span class="n">body_handle</span><span class="p">).</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;car rigid body not found&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="kd">let</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">rigid_body</span><span class="p">.</span><span class="n">position</span><span class="p">().</span><span class="n">translation</span><span class="p">.</span><span class="n">vector</span><span class="p">;</span>
</span><span class='line'>            <span class="kd">let</span> <span class="n">rot</span> <span class="o">=</span> <span class="n">rigid_body</span><span class="p">.</span><span class="n">position</span><span class="p">().</span><span class="n">rotation</span><span class="p">;</span>
</span><span class='line'>            <span class="kd">let</span> <span class="n">vel</span> <span class="o">=</span> <span class="n">rigid_body</span><span class="p">.</span><span class="n">velocity</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="kd">let</span> <span class="n">rot</span> <span class="o">:</span> <span class="n">Basis2</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Rotation2</span><span class="o">::&lt;</span><span class="kt">f64</span><span class="o">&gt;::</span><span class="n">from_angle</span><span class="p">(</span><span class="n">Rad</span><span class="p">(</span><span class="n">rot</span><span class="p">.</span><span class="n">unwrap</span><span class="p">().</span><span class="n">re</span><span class="p">));</span>
</span><span class='line'>            <span class="kd">let</span> <span class="n">yaw_increment</span> <span class="o">=</span> <span class="n">vel</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span> <span class="k">as</span> <span class="kt">f32</span> <span class="o">/</span> <span class="p">(</span><span class="n">car</span><span class="p">.</span><span class="n">bb_size</span><span class="p">.</span><span class="n">height</span> <span class="k">as</span> <span class="kt">f32</span> <span class="o">/</span> <span class="mf">2.0</span><span class="k">f32</span><span class="p">)</span>  <span class="o">*</span>  <span class="n">car</span><span class="p">.</span><span class="n">wheel_yaw</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>            <span class="n">rigid_body</span><span class="p">.</span><span class="n">set_angular_velocity</span><span class="p">(</span><span class="n">yaw_increment</span> <span class="k">as</span> <span class="kt">f64</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>UpdateCarsSys ist eine Klasse, die die Winkelgeschwindigkeit nach die Ackermann Lenkmodell  verändern. Die Klasses tut nur das. Die run() Methode wird bei jedem Frame laufen.
In ein System, man kannt eine Query ǘber die Komponenten tun. Dann, kannst du die Ergebnisliste iteriren. Die Komponenten, die du kannst ändern, können mit <strong>mut</strong> markiert werden.</p>

<h2>Links</h2>

<p><a href="https://github.com/clynamen/roadsim2d">roadsim2d</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vincenzo Giovanni Comito</span></span>

      








  


<time datetime="2019-02-04T01:00:00+02:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/prototype/'>prototype</a>, <a class='category' href='/blog/categories/rust/'>rust</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://clynamen.github.io/blog/2019/02/04/carsim2d/" data-via="cIynamen" data-counturl="http://clynamen.github.io/blog/2019/02/04/carsim2d/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2017/10/15/sdc-weekly_de/" title="Previous Post: Self Driving Car Weekly Highlights | Week 08/10/17 - 15/10/17 [EN]">&laquo; Self Driving Car Weekly Highlights | Week 08/10/17 - 15/10/17 [EN]</a>
      
      
        <a class="basic-alignment right" href="/blog/2019/05/31/julia_opencv/" title="Next Post: Julia and the current status of OpenCV bindings">Julia and the current status of OpenCV bindings &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/05/02/buy_a_car_with_data-pt1/">Buy a car with data - Part 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/04/23/basic_http_webm_server_rust/">A basic HTTP WebM server in rust</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/06/16/julia_def_fun_macro/">Programmatically create function in Julia with metaprogramming</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/05/31/julia_opencv/">Julia and the current status of OpenCV bindings</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/02/04/carsim2d/">Experimente mit Rust - Carsim2d [DE]</a>
      </li>
    
  </ul>
</section>

<section id="twitter">
  <h1 class="tweets">Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("cIynamen", , );
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <p>Follow <a href="http://twitter.com/cIynamen">@cIynamen</a></p>
  
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/clynamen">@clynamen</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'clynamen',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2020 -  Vincenzo Giovanni Comito <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> + <a href="https://github.com/clynamen/wired_next">theme: wired_next, a mnml fork</a>.
	  
  </span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'clynamen-github-io';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://clynamen.github.io/blog/2019/02/04/carsim2d/';
        var disqus_url = 'http://clynamen.github.io/blog/2019/02/04/carsim2d/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
